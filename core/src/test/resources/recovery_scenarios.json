{
  "schema": "iglu:com.snowplowanalytics.snowplow/recoveries/jsonschema/4-0-0",
  "data": {
    "iglu:com.snowplowanalytics.snowplow.badrows/adapter_failures/jsonschema/1-0-*": [{
      "name": "zero",
      "conditions": [{
          "op": "Test",
          "path": "$.payload.querystring.[?(@.name=~schema)].value",
          "value": {"value": "iglu"}
        }],
      "steps": [{
          "op": "Replace",
          "path": "$.querystring.[?(@.name=~schema)].value",
          "value": "iglu:com.snowplowanalytics.snowplow/audio_impression/jsonschema/1-0-0"
        },
        {
          "op": "Replace",
          "path": "$.querystring.[?(@.name=~app_id)].value",
          "value": "badcock-furniture-646ed61e-3427-4d2a-9c55-7c5ca9299378"
        }
      ]
    }],    
    "iglu:com.snowplowanalytics.snowplow.badrows/adapter_failures/jsonschema/1-0-*": [
      {
        "name": "first",
        "conditions": [{
          "op": "Test",
          "path": "$.payload.querystring.[?(@.name=~page)].value",
          "value": ""
        }],
        "steps": [{
          "op": "Replace",
          "path": "$.querystring.[?(@.name=~page)].value",
          "value": "FixedQueryParams"
        }]
      }      
    ],
    "iglu:com.snowplowanalytics.snowplow.badrows/adapter_failures/jsonschema/1-0-*": [
      {
        "name": "second",
        "conditions": [],
        "steps": [{
          "op": "Replace",
          "path": "$.querystring",
          "value": [{"name": "e", "value": "pv"},{"name": "page", "value": "DemoPageTitle"}]
        }]
      }      
    ],    
    "iglu:com.snowplowanalytics.snowplow.badrows/enrichment_failures/jsonschema/1-0-*": [
      {
        "name": "impossible flow",
        "conditions": [

        ],
        "steps": []
      }
    ],
    "iglu:com.snowplowanalytics.snowplow.badrows/schema_violations/jsonschema/2-0-0":[
      {
        "name":"changeEventKey",
        "conditions":[
          {
            "op": "Test",
            "path": "$.failure.messages[0].error.dataReports[0].targets.[0]",
            "value": {
              "regex": "\"agent\""
            }
          }
        ],
        "steps":[
          {
            "op":"Replace",
            "path":"$.raw.parameters.cx.data.[2].data",
            "match":"\"agent\"",
            "value":"\"agents\""
          }
        ]
      }
    ]
  }
}
